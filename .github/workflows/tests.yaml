name: "action-test"
on:
  push:
  pull_request:
  workflow_dispatch:
    inputs:
      ref:
        description: "the git revision to checkout"
        required: false
      repo:
        description: "repository to scan"
        required: false
      input_path:
        description: "path to the repository"
        default: "."
        required: false
      output_path:
        description: "path to store the sbom"
        default: "."
        required: false

jobs:

  test-as-action:
    runs-on: ubuntu-22.04
    steps:

      - name: Checkout
        uses: actions/checkout@v4
        with:
          path: ./


      # - name: Download artifact
      #   uses: ./
      #   with:
      #     artifact-url: https://distro.ibiblio.org/tinycorelinux/15.x/x86/release/Core-15.0.iso

      - name: Install scanners
        uses: ./
        with:
          grype-version: 0.76.0

      # - name: Print the content of generated sbom file
      #   run: |
      #     for sbom in repo_*.json; do
      #       echo "Content of $sbom"
      #       cat $sbom
      #     done
      #     for sbom in repo_*.html; do
      #       echo "Content of vulnerability result for SBOM: $sbom"
      #       cat $sbom
      #     done
